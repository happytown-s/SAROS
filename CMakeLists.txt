cmake_minimum_required(VERSION 3.15)
project(SAROS VERSION 1.0.0)

# ğŸ Apple Silicon å‘ã‘ãƒ“ãƒ«ãƒ‰è¨­å®š (macOSã®ã¿)
if(APPLE)
    set(CMAKE_OSX_ARCHITECTURES "arm64")
endif()

# JUCEã®ãƒ‘ã‚¹è¨­å®š
# CIç’°å¢ƒã§ã¯ -DCI_BUILD=ON ã‚’æŒ‡å®šã—ã¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã®JUCEã‚’ä½¿ç”¨
# ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®JUCEãƒ‘ã‚¹ã‚’ä½¿ç”¨
option(CI_BUILD "CIç’°å¢ƒã§ã®ãƒ“ãƒ«ãƒ‰" OFF)

if(CI_BUILD)
    # CIç’°å¢ƒ: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸJUCEã‚’ä½¿ç”¨
    set(JUCE_DIR "${CMAKE_CURRENT_SOURCE_DIR}/JUCE")
else()
    # ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒ: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®JUCEãƒ‘ã‚¹ã‚’ä½¿ç”¨
    set(JUCE_DIR "/Users/mtsh/JUCE")
endif()

message(STATUS "Using JUCE from: ${JUCE_DIR}")

add_subdirectory(${JUCE_DIR} "${CMAKE_CURRENT_BINARY_DIR}/JUCE_build")

# GUIã‚¢ãƒ—ãƒªã®å®šç¾©
juce_add_gui_app(SAROS
    COMPANY_NAME "BabyLeaf"
    PRODUCT_NAME "SAROS"
    OUTPUT_NAME "SAROS"
    OUTPUT_DIRECTORY "${CMAKE_BINARY_DIR}/SAROSApp"
)

# ãƒã‚¤ãƒŠãƒªãƒ‡ãƒ¼ã‚¿ï¼ˆãƒ•ã‚©ãƒ³ãƒˆãªã©ï¼‰ã®å®šç¾©
juce_add_binary_data(Assets
    SOURCES
        Source/Assets/Orbitron-Bold.ttf
)

set_target_properties(SAROS PROPERTIES RUNTIME_OUTPUT_DIRECTORY "${CMAKE_BINARY_DIR}/SAROSApp")

# ã‚½ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«
set(SOURCE_FILES
    Source/Main.cpp
    Source/MainComponent.cpp
    Source/LooperAudio.cpp
    Source/InputManager.cpp
    Source/TransportPanel.cpp
    Source/LooperTrackUi.cpp
    Source/FXPanel.cpp
    Source/PlanetKnobLookAndFeel.cpp
)

set(HEADER_FILES
    Source/ThemeColours.h
    Source/Util.h
    Source/TrackUtils.h
    Source/InputManager.h
    Source/InputTap.h
    Source/LooperAudio.h
    Source/LooperTrackUi.h
    Source/TransportPanel.h
    Source/FXPanel.h
    Source/PlanetKnobLookAndFeel.h
    Source/TriggerEvent.h
    Source/SmartGate.h
    Source/MainComponent.h
    Source/RoundButtonLookAndFeel.h
    Source/CircularVisualizer.h
    Source/FilterSpectrumVisualizer.h
)


# MSVCå¯¾å¿œ: ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’UTF-8ã¨ã—ã¦æ‰±ã†
if (MSVC)
    target_compile_options(SAROS PRIVATE /utf-8)
endif()

target_sources(SAROS PRIVATE ${SOURCE_FILES} ${HEADER_FILES})

# ä½¿ç”¨ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
target_link_libraries(SAROS PRIVATE
    Assets
    juce::juce_gui_basics
    juce::juce_gui_extra
    juce::juce_audio_basics
    juce::juce_audio_utils
    juce::juce_graphics
    juce::juce_dsp
    juce::juce_core
    juce::juce_events
)
